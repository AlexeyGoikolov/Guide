@using Microsoft.AspNetCore.Identity
@model User
@inject UserManager<User> UserManager
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{
    ViewBag.Title = "Личный кабинет";
    Layout = "_Layout";
}

<div class="page">
    <div class="pageheader">
    
            <h2>@ViewBag.Title : @Model.Name @Model.Surname</h2>
    
            <div class="page-bar">
    
                <ul class="page-breadcrumb">
                    <li>
                        <a asp-action="Profile" asp-controller="Service"><i class="fa fa-home"></i> Guide</a>
                    </li>
                    <li>
                     <a asp-action="Profile" asp-controller="Service" asp-route-id="@Model.Id">@ViewBag.Title</a>
                    </li>
                </ul>
            </div>
        </div>
    @if (UserManager.GetUserId(User) == Model.Id)
    {
        <a asp-action="Edit" asp-controller="Account" asp-area="" asp-route-id="@Model.Id" class="btn btn-info">Изменить личные данные</a>
        <a asp-action="ChangePassword" asp-controller="Account" asp-area="" asp-route-id="@Model.Id" class="btn btn-danger">Изменить пароль</a>
    }



</div>

@section Scripts
{
    <script >
        $(".BlockingAjax").click(function() {
            var id = $(this).attr("id");
            $.ajax({url: '@Url.Action("BlockingAjax", "UsersManage")',type : 'POST',data : {'idUser' : id},
                success : function f(data)  {
                    if (data){
                        $("#"+id).html('Отключить');
                        $("."+id).html("<p>Активный</p>");
                        $('#info').html("")
                    }
                    else{
                        $("#"+id).html('Подключить');
                        $("."+id).html("<p>Заблокирован</p>");
                        $('#info').html("Пользователь отключен")
                    }
                }
            })
        });
    </script>
}
